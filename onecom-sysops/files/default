#
# In most cases, administrators will remove this file from sites-enabled/ and
# leave it as reference inside of sites-available where it will continue to be
# updated by the nginx packaging team.
#
# This file will automatically load configuration files provided by other
# applications, such as Drupal or Wordpress. These applications will be made
# available underneath a path with that package name, such as /drupal8.
#
# Please see /usr/share/doc/nginx-doc/examples/ for more detailed examples.
##

# Default server configuration
#

#server {
#        listen 80;
#       server_name sysops.one.com;
#       location = / {
#       return 301 https://sysops.one.com;
#       }
#}

server {
        listen 443 default_server;
        listen [::]:443 default_server;

    ssl                       on;
    ssl_protocols             TLSv1 TLSv1.2;
    ssl_certificate           /etc/one.com/ssl/wildcard_one_com.crt;
    ssl_certificate_key       /etc/one.com/ssl/wildcard_one_com.key;
    ssl_ciphers               "HIGH:RC4+RSA:!aNULL:!MD5:!kEDH:!3DES";
    ssl_prefer_server_ciphers on;
    client_max_body_size 32M;
        location /opsutils {
                # First attempt to serve request as file, then
                # as directory, then fall back to displaying a 404.
                proxy_pass http://localhost:8082/opsutils;
        }
        
        location /migrations {
                proxy_pass http://localhost:8888/migrations;
}
#       location = /ipblock {
#               deny all;
#}
                        

#
#                proxy_pass http://sysops1.env.tools-cph3.one.com:8080/getblacklist;
#}              
#       location /migrationstatus {
#               root /usr/share/nginx/html/ ;
#               index webmigrationstatus.php;
#}

        include /etc/nginx/fcgiwrap.conf;
        include /etc/nginx/php.conf;
        include /etc/nginx/mailqueue.conf;
        include /etc/nginx/migrationstatus.conf;
#        include /etc/nginx/access.conf;
}
